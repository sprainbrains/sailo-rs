---
variables: &variables
  SFOS_VERSION: 3.4.0.24
  CARGO_HOME: $CI_PROJECT_DIR/cargo

stages:
  - docker
  - build
  - test
  - deploy

.docker:builder: &docker-builder
  image:
    name: gcr.io/kaniko-project/executor:debug
    entrypoint: [""]
  stage: docker
  script:
    - ./kaniko.sh

armv7hl-3.4:
  <<: *docker-builder
  variables:
    SFOS_ARCH: armv7hl
    CROSS_NAME_SHORT: arm
    RUST_TARGET: armv7-unknown-linux-gnueabihf

aarch64-3.4:
  <<: *docker-builder
  variables:
    SFOS_ARCH: aarch64
    CROSS_NAME_SHORT: aarch64
    RUST_TARGET: aarch64-unknown-linux-gnu

i486-3.4:
  <<: *docker-builder
  variables:
    SFOS_ARCH: i486
    CROSS_NAME_SHORT: i686
    RUST_TARGET: i686-unknown-linux-gnu
